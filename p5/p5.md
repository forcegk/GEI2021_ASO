# Practica 5 - ASO

Añadimos las interfaces de red nuevas en las VMs:
- **ASO 1**:
    1. NAT: *Intel PRO/1000MT Desktop*
    2. Red interna: *PCnet-FAST III*
    3. Red interna: *PCnet-FAST III*

- **ASO 2**:
    1. NAT: *Intel PRO/1000MT Desktop*
    2. Red interna: *Intel PRO/1000MT Desktop*
    3. Red interna: *Intel PRO/1000MT Desktop*

- **ASO 3**:
    1. NAT: *Intel PRO/1000MT Desktop*
    2. Red interna: *Intel PRO/1000MT Desktop*
    3. Red interna: *Intel PRO/1000MT Desktop*

## Solaris 10
### Configuración de red
```bash
#!/bin/bash

# set -e

# INTERFACES="e1000g0 pcn0 pcn0:1 pcn0:2 pcn0:3 pcn1 pcn1:1 pcn1:2 pcn1:3"

# interface list $1, command $s2
# loop_ifaces() {
#     echo $1
#     for iface in $1; do
#         echo Plumbing $iface
#         ifconfig $iface $2
#     done
# }

# configure_ifaces() {
#     echo Configuring e1000g0 dhcp
#     ifconfig e1000g0 dhcp

#     echo Configuring pcn0:0..3
#     ifconfig pcn0 inet 192.168.2.11/24
#     ifconfig pcn0:1 inet 192.168.20.11/24
#     ifconfig pcn0:2 inet 192.168.21.11/24
#     ifconfig pcn0:3 inet 192.168.22.11/24

#     echo Configuring pcn1:0..3
#     ifconfig pcn1 inet 192.168.3.11/24
#     ifconfig pcn1:1 inet 192.168.30.11/24
#     ifconfig pcn1:2 inet 192.168.31.11/24
#     ifconfig pcn1:3 inet 192.168.32.11/24
# }

# Configurar
#loop_ifaces "$INTERFACES" plumb
#configure_ifaces
#loop_ifaces "$INTERFACES" up

# Desconfigurar
#loop_ifaces "$INTERFACES" down
#loop_ifaces "$INTERFACES" unplumb

#!/bin/bash

set -e

configure_ifaces_persistent() {
    echo Configuring e1000g0 dhcp
    touch /etc/hostname.e1000g0
    touch /etc/dhcp.e1000g0

    echo Configuring pcn0:0..3
    echo "192.168.2.11 netmask 255.255.255.0" > /etc/hostname.pcn0
    echo "192.168.20.11 netmask 255.255.255.0" >  /etc/hostname.pcn0:1
    echo "192.168.21.11 netmask 255.255.255.0" >  /etc/hostname.pcn0:2
    echo "192.168.22.11 netmask 255.255.255.0" >  /etc/hostname.pcn0:3

    echo Configuring pcn1:0..3
    echo "192.168.3.11 netmask 255.255.255.0" > /etc/hostname.pcn1
    echo "192.168.30.11 netmask 255.255.255.0" >  /etc/hostname.pcn1:1
    echo "192.168.31.11 netmask 255.255.255.0" >  /etc/hostname.pcn1:2
    echo "192.168.32.11 netmask 255.255.255.0" >  /etc/hostname.pcn1:3

    echo Restarting network/physical
    svcadm disable network/physical
    svcadm enable network/physical
}

configure_ifaces_persistent

```
Buscar interfaces: `dmesg | egrep 'e1000g|pcn'`

Comprobar configuración: `ifconfig -a`

## OpenBSD 6.8
### Configuración de red

```bash
#!/bin/csh

echo Configuring em0 dhcp
echo "dhcp" > /etc/hostname.em0
chmod 640 /etc/hostname.em0

echo Configuring pcn0
cat << EOS > /etc/hostname.pcn0
inet 192.168.2.11 255.255.255.0
inet alias 192.168.20.11 255.255.255.0
inet alias 192.168.21.11 255.255.255.0
inet alias 192.168.22.11 255.255.255.0
EOS
chmod 640 /etc/hostname.pcn0

echo Configuring pcn1
cat << EOS > /etc/hostname.pcn1
inet 192.168.3.11 255.255.255.0
inet alias 192.168.30.11 255.255.255.0
inet alias 192.168.31.11 255.255.255.0
inet alias 192.168.32.11 255.255.255.0
EOS
chmod 640 /etc/hostname.pcn1

echo Updating netstart rules
#doas -u root sh /etc/netstart
sh /etc/netstart
```

## Devuan
### Configuración de red

```bash
#!/bin/bash

set -e

echo Configuring interfaces
cat << EOS > /etc/network/interfaces.d/intnet
auto eth1 eth1:1 eth1:2 eth1:3

iface eth1 inet static
    address 192.168.2.11/24

iface eth1:1 inet static
    address 192.168.20.11/24

iface eth1:2 inet static
    address 192.168.21.11/24

iface eth1:3 inet static
    address 192.168.22.11/24


auto eth2 eth2:1 eth2:2 eth2:3

iface eth2 inet static
    address 192.168.3.11/24

iface eth2:1 inet static
    address 192.168.30.11/24

iface eth2:2 inet static
    address 192.168.31.11/24

iface eth2:3 inet static
    address 192.168.32.11/24
EOS

/etc/init.d/networking stop
/etc/init.d/networking start
```