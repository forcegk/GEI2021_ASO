# Práctica 8 - ASO

## Copia de seguridad con shell script
```bash
#!/bin/sh

set -e

BACKUP_DIR="/var/backups"
#BACKUP_LIM=10
#BACKUP_LOG=YES
#BACKUP_LOG_PRIO="user.notice"
BACKUP_HOME_DIR="/home"
BACKUP_COMPRESSION_LEVEL="9"

compress_directory() {
	# Comprueba si es un directorio
	if [ ! -d "$1" ]; then
		# echo "$1 is not a file"
		return 1
	fi
	echo "compress $1 to $2"
	tar -cvf - "$1" | gzip -c"$BACKUP_COMPRESSION_LEVEL" > "$2"
}

get_formatted_date() {
	date +"%Y%m%d_%H%M%S"
}

dir_exists() {
	if [ ! -d "$1" ]; then
		echo "$1 does not exist or is not a directory"
		return 1
	fi
	return 0
}

dir_exists "$BACKUP_DIR"

for f in "$BACKUP_HOME_DIR"/*
do
	DATE=$(get_formatted_date)
	DEST="$BACKUP_DIR"/$(basename "$f")_"$DATE".tar.gz
	compress_directory "$f" "$DEST"
done

```

## Envío de logs

### Devuan

### Solaris 10

### OpenBSD 6.8

### FreeBSD

### Fedora

### Solaris 11

### Ubuntu