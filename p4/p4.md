# Practica 4 - ASO

## Solaris 10
### Añadir usuarios
```bash
#!/bin/bash

set -e

# Anadir usuarios
for i in {1..10}; do
    echo Adding user$(printf "%03d" $i)
    useradd -m -d /export/home/user$(printf "%03d" $i) user$(printf "%03d" $i)
done

# Anadir grupos
for gname in verde amarillo rojo; do
    echo Adding group $gname
    groupadd $gname
done

# Anadir usuarios a grupos
for uname in user001 user002 user003 pc; do
    echo Adding $uname to verde
    usermod -G verde $uname
done
for uname in user007 user008 user009; do
    echo Adding $uname to rojo
    usermod -G rojo $uname
done
for uname in user010; do
    echo Adding $uname to amarillo
    usermod -G amarillo $uname
done

# Set expiration date
for uname in user005 user006; do
    echo Setting expiry date of $uname to 10-Apr-2021
    usermod -e 4/10/2021 $uname
    echo "Setting password expiry time to 30 days"
    passwd -x 30 $uname
done

echo "Cambiar contrasenas a mano de users1-10"
for i in {1..10}; do
    echo "Changing password for user$(printf "%03d" $i)"
    passwd user$(printf "%03d" $i)
done
```

## OpenBSD 6.8
### Añadir usuarios

```bash
#!/bin/ksh

# Para establecer la contrasena mientras se crea el usuario:
# encpass=$(encrypt -b8 contrasena)
# useradd -m $username -p $encpass

# Anadir usuarios
i=1
while [ $i -le 10 ]
do
  username=$(printf "user%03d" $i)
  echo "Adding user $username"
  useradd -m $username
  i=$((i+1))
done

# Anadir grupos
echo "Creating groups verde, amarillo, rojo"
groupadd verde
groupadd amarillo
groupadd rojo

# Anadir usuarios a verde
i=1
while [ $i -le 3 ]
do
  username=$(printf "user%03d" $i)
  echo "Adding $username to group verde"
  usermod -G verde $username
  i=$((i+1))
done

# Anadir usuarios a rojo
i=7
while [ $i -le 9 ]
do
  username=$(printf "user%03d" $i)
  echo "Adding $username to group rojo"
  usermod -G rojo $username
  i=$((i+1))
done

# Anadir usuarios a amarillo
echo "Adding user010 to group verde"
usermod -G rojo user010

# Establecer fecha de caducidad a 10 de abril de 2021
# y periodo de envejecimiento 30 días
echo "Setting password expiry time to 30 days for user005, user006"
usermod -e "apr 10 2021" -f 30d user005
usermod -e "apr 10 2021" -f 30d user006

# Cambiar contrasenas a mano de todos los usuarios
echo "Manually set passwords for new users:"
i=1
while [ $i -le 10 ]
do
  username=$(printf "user%03d" $i)
  passwd $username
  i=$((i+1))
done
```

## Devuan
### Añadir usuarios
```bash
#!/bin/bash

set -e

# Anadir usuarios
for i in {1..10}; do
    echo Adding user$(printf "%03d" $i)
    useradd -m user$(printf "%03d" $i) -p $(perl -e 'print crypt("pc1234", "password")')
                                     # ^^ Esto es inseguro, pero por comodidad lo pongo aquí
done

# Anadir grupos
for gname in verde amarillo rojo; do
    echo Adding group $gname
    groupadd $gname
done

# Anadir usuarios a grupos
for uname in user001 user002 user003 pc; do
    echo Adding $uname to verde
    usermod -aG verde $uname
done
for uname in user007 user008 user009; do
    echo Adding $uname to rojo
    usermod -aG rojo $uname
done
for uname in user010; do
    echo Adding $uname to amarillo
    usermod -aG amarillo $uname
done

# Set expiration date
for uname in user005 user006; do
    echo Setting expiry date of $uname to 10-Apr-2021
    usermod -e 2021-04-10 $uname
    echo "Setting password expiry time to 30 days"
    passwd -x 30 $uname
done

# Establecer user005 como administrador de amarillo y rojo
for group in amarillo rojo; do
    gpasswd -A user005 $group
done
```

## FreeBSD
### Añadir usuarios
```bash
#!/bin/tcsh

# Anadir usuarios
foreach i ( `seq 1 10` )
    echo Adding user`printf "%03d" $i`
    pw useradd -m -n user`printf "%03d" $i`
end

# Anadir grupos
foreach gname ( verde amarillo rojo )
    echo Adding group $gname
    pw groupadd -n $gname
end

# Anadir usuarios a grupos
echo Adding user001,user002,user003,pc to verde
pw groupmod verde -m user001,user002,user003,pc

echo Adding user007,user008,user009 to rojo
pw groupmod rojo -m user007,user008,user009

echo Adding user010 to verde
pw groupmod amarillo -m user010

# Set expiration date
foreach uname ( user005 user006)
    echo "Setting expiry date of $uname to 10-Apr-2021 (1618005600) and password expiry time to 30 days"
    pw usermod -e 1618005600 -p +30d -n $uname
end
```

## Fedora
### Añadir usuarios
```bash
#!/bin/bash

# Anadir usuarios
for i in {1..10}; do
    echo Adding user$(printf "%03d" $i)
    useradd -m user$(printf "%03d" $i) -p $(perl -e 'print crypt("pc1234", "password")')
                                     # ^^ Esto es inseguro, pero por comodidad lo pongo aquí
done

# Anadir grupos
for gname in verde amarillo rojo; do
    echo Adding group $gname
    groupadd $gname
done

# Anadir usuarios a grupos
for uname in user001 user002 user003 pc; do
    echo Adding $uname to verde
    usermod -aG verde $uname
done
for uname in user007 user008 user009; do
    echo Adding $uname to rojo
    usermod -aG rojo $uname
done
for uname in user010; do
    echo Adding $uname to amarillo
    usermod -aG amarillo $uname
done

# Set expiration date
for uname in user005 user006; do
    echo Setting expiry date of $uname to 10-Apr-2021
    usermod -e 2021-04-10 $uname
    echo "Setting password expiry time to 30 days"
    passwd -x 30 $uname
done

# Establecer user005 como administrador de amarillo y rojo
for group in amarillo rojo; do
    gpasswd -A user005 $group
done
```

## Notas:

### Cambio distribución de teclado

#### OpenBSD
Para cambiar la distribución a *US*: `kbd us`
Para hacer el cambio persistente: `wsconsctl keyboard.encoding=us`

#### Devuan
Para cambiar la distribución a *US*: `dpkg-reconfigure keyboard-configuration`
Seleccionar Generic 104 Key PC > English (US)