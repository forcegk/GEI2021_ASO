# Practica 6 - ASO

## Solaris 10
### Instalación Interactiva de VBox Additions
```bash
#!/bin/bash

set -e

echo "Inserta el CD de VirtualBox Guest Additions, espera a que se automonte, y pulsa <ENTER> para continuar..."
read
pushd /cdrom/vboxadditions_* > /dev/null

pkgadd -d ./VBoxSolarisAdditions.pkg

echo "Reinicia o reloguea para aplicar los cambios y ejecuta el segundo script!"
```

### Instalación Interactiva del resto de Paquetes
```bash
#!/bin/bash

set -e

mkdir -p /export/home/pc/pkg
pushd /export/home/pc/pkg > /dev/null

# Descargamos los paquetes
/usr/sfw/bin/wget "http://www.dc.fi.udc.es/~afyanez/Docencia/2021/Grado/files/FSWpart.tar.gz" --no-check-certificate & 
/usr/sfw/bin/wget "http://www.dc.fi.udc.es/~afyanez/Docencia/2021/Grado/files/FSWfsmisc.tar.gz" --no-check-certificate  & 
/usr/sfw/bin/wget "https://get.geo.opera.com/ftp/pub/opera/unix/solaris/1011/en/intel/opera-10.11.gcc4-static-qt3.pkg.gz" --no-check-certificate &
wait

gunzip FSWpart.tar.gz &
gunzip FSWfsmisc.tar.gz &
gunzip opera-10.11.gcc4-static-qt3.pkg.gz &
wait

tar xvf FSWpart.tar &
tar xvf FSWfsmisc.tar &
wait

pkgadd -d . FSWpart
pkgadd -d . FSWfsmisc
pkgadd -d ./opera-10.11.gcc4-static-qt3.pkg

popd > /dev/null
echo "Comprueba que Opera funciona (/usr/local/bin/opera) y listo!"
```

## OpenBSD 6.8

### Instalación de paquetes y configuración login gráfico
```bash
#!/bin/ksh

# Salir si ocurre un error
set -e

# Habilitar login grafico
echo "Habilitar xenodm"
rcctl enable xenodm

packages="firefox icewm"
echo "Instalar paquetes: $packages"
#pkg_info $packages
pkg_add $packages

echo "Establecer icewm como window manager de user001-005"
i=1
while [ $i -le 10 ]
do
  username=$(printf "user%03d" $i)
  echo "Setting icewm as $username's wm"
  userhome=$(getent passwd $username | cut -d: -f6)
  echo "exec icewm" > $userhome/.xsession
  i=$((i+1))
done

echo "Configurar un solo escritorio en fvwm de forma global"
# Explicacion del comando
# -i: Modificar archivo sobre si mismo (no enviar a stdout)
# /: Buscar texto
# ^DeskTopSize 3x3$: Busca el texto entre inicio y fin de linea
# /s: Substituir texto
#     /^ Cambiar "inicio de linea"
#     /# por "#"
#     /; finalizar comando
#     /^#DesktopSize 3x3$: buscar
#     /a: Append texto
sed -i '/^DeskTopSize 3x3$/s/^/#/;/^#DeskTopSize 3x3$/a\
DeskTopSize 1x1' /usr/X11R6/lib/X11/fvwm/.fvwmrc

# Instala sistema de ports
echo "Sistema de ports"
mirror="https://cdn.openbsd.org/pub/OpenBSD/"
#mirror="https://cloudflare.cdn.openbsd.org/pub/OpenBSD/"
cd /tmp
# Descarga del archivo ports
ftp $mirror$(uname -r)/{ports.tar.gz,SHA256.sig}

# Comprueba que esta firmado con la clave privada de openbsd
echo "Comprobando firmas digitales"
signify -Cp /etc/signify/openbsd-$(uname -r | cut -c 1,3)-base.pub -x SHA256.sig ports.tar.gz
cd -

echo "Descomprimir ports.tar.gz en /usr/ports"
tar xzf /tmp/ports.tar.gz -C /usr
rm /tmp/ports.tar.gz

# Añade portslist al gestor de paquetes del sistema
pkg_add portslist

# Ejemplos de busqueda
#cd /usr/ports
#make search name=links
#make search key=lynx

cd /usr/ports/www/links
make
make install
cd -

cd /usr/ports/www/lynx
make
make install
cd -

echo "Presiona una tecla para arrancar xenodm"
read
rcctl start xenodm
```

### Listado de paquetes instalados
```pkg_info -a``` para listar paquetes instalados,
```pkg_info -a``` para incluír los de sistema


## Devuan

## Fedora

## FreeBSD

## Solaris 11
### Instalación interactiva de VBox Additions y entorno gráfico
```bash
#!/bin/bash

set -e
# El disco se monta automáticamente en /cdrom/<label> o cdrom0
# Confirmamos dos veces con *y*
pkgadd -d /cdrom/cdrom0/VBoxSolarisAdditions.pkg

# Actualizar sistema
#pkg update

# Entorno de escritorio
pkg install solaris-desktop
```
### Lista de paquetes instalados
`pkginfo`

## Ubuntu